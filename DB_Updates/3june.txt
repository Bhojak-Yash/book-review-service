CREATE TABLE `sales_header` (
  `id` INT NOT NULL AUTO_INCREMENT,
   `invNo` VARCHAR(255) DEFAULT NULL,
  `date` DATETIME DEFAULT NULL,
  `partyId` INT DEFAULT NULL,
  `address` VARCHAR(255) DEFAULT NULL,
  `subTotal` DECIMAL(10,2) DEFAULT NULL,
  `discount` DECIMAL(10,2) DEFAULT NULL,
  `totalAmt` DECIMAL(10,2) DEFAULT NULL,
  `balance` DECIMAL(10,2) DEFAULT NULL,
  `SGST` DECIMAL(10,2) DEFAULT NULL,
  `CGST` DECIMAL(10,2) DEFAULT NULL,
  `IGST` DECIMAL(10,2) DEFAULT NULL,
  `organisationId` INT DEFAULT NULL,
  `paymentMode` ENUM('Cash','Online','Credit','Card') DEFAULT NULL,
  `orderStatus` ENUM(
    'Pending', 'Confirmed', 'Rejected', 'Ready to ship', 'Ready to pickup',
    'Dispatched', 'Inward', 'Paid', 'Partially paid', 'Cancelled', 'Settled'
  ) DEFAULT NULL,
  `inv_url` VARCHAR(255) DEFAULT NULL,
   `createdAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ;


CREATE TABLE `sales_details` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `headerId` BIGINT DEFAULT NULL,
  `PId` BIGINT DEFAULT NULL,
  `SId` BIGINT DEFAULT NULL,
  `qty` INT DEFAULT NULL,
  `MRP` DECIMAL(10,2) DEFAULT NULL,
  `rate` DECIMAL(10,2) DEFAULT NULL,
  `SGST` DECIMAL(10,2) DEFAULT NULL,
  `CGST` DECIMAL(10,2) DEFAULT NULL,
  `IGST` DECIMAL(10,2) DEFAULT NULL,
  `amount` DECIMAL(10,2) DEFAULT NULL,
  `scheme` VARCHAR(255) DEFAULT NULL,
   `createdAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
);



CREATE TABLE `partyList` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `companyName` VARCHAR(255) NOT NULL,
  `State` VARCHAR(255) NOT NULL,
  `city` VARCHAR(255) NOT NULL,
  `ownerName` VARCHAR(255) DEFAULT NULL,
  `profilePic` VARCHAR(255) DEFAULT NULL,
  `address` VARCHAR(255) NOT NULL,
  `phone` BIGINT NOT NULL,
  `FSSAI` VARCHAR(255) DEFAULT NULL,
  `drugLicense` VARCHAR(255) DEFAULT NULL,
  `email` VARCHAR(255) DEFAULT NULL,
  `organisationId` BIGINT DEFAULT NULL,
  `status` ENUM('Active', 'Inactive') DEFAULT NULL,
  `companyType` ENUM(
    'Sole Proprietorship',
    'Partnership Firm',
    'Limited Liability Partnership (LLP)',
    'Private Limited Company',
    'Public Limited Company',
    'One Person Company (OPC)',
    'Section 8 Company',
    'Producer Company',
    'Nidhi Company',
    'Unlimited Company',
    'Other'
  ) DEFAULT NULL,
  `PAN` VARCHAR(255) DEFAULT NULL,
  `GST` VARCHAR(255) DEFAULT NULL,
  `CIN` VARCHAR(255) DEFAULT NULL,
  `accountNumber` BIGINT DEFAULT NULL,
  `AccHolderName` VARCHAR(255) DEFAULT NULL,
  `IFSC` VARCHAR(255) NOT NULL,
   `createdAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
);


CREATE UNIQUE INDEX idx_unique_company_organisation
ON partyList (companyName, organisationId);


ALTER TABLE `crm_db`.`sales_header` 
ADD COLUMN `deliveryType` VARCHAR(255) NULL AFTER `updatedAt`,
ADD COLUMN `deliveryDate` DATETIME NULL AFTER `deliveryType`,
ADD COLUMN `extraDiscountValue` d(10,2) NULL AFTER `deliveryDate`,
ADD COLUMN `extraDiscountPercent` DECIMAL(10,2) NULL AFTER `extraDiscountValue`,
ADD COLUMN `advance` DECIMAL(10,2) NULL AFTER `extraDiscountPercent`;